# kate: indent-width 2;

branches:
  only:
  - master
  - compatibility

os:
- linux

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - kalakris-cmake
    packages:
    - cmake

install:
# so the directory tests pass (and then some workaround for crazy filesystem issues)
- if [ "$TRAVIS_OS_NAME" == "linux" ]; then mkdir -p ~/.config/autostart; fi
- if [ "$TRAVIS_OS_NAME" == "linux" ]; then mkdir -p ~/.local; fi
- if [ "$TRAVIS_OS_NAME" == "linux" ]; then export CXXFLAGS=-DTRAVIS_CI_HAS_CRAZY_FILESYSTEM_ON_LINUX; fi

script:
- mkdir build && cd build
- cmake -DBUILD_TESTS=ON -DCMAKE_BUILD_TYPE=Release ..
- cmake --build .
- ctest --output-on-failure
